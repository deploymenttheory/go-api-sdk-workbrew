package vulnerabilitychanges

import "time"

// VulnerabilityChange represents a single vulnerability change event
type VulnerabilityChange struct {
	ID                 string    `json:"id"`
	EventType          string    `json:"event_type"`
	OccurredAt         time.Time `json:"occurred_at"`
	Status             string    `json:"status"`
	DeviceID           *string   `json:"device_id"`
	DeviceSerialNumber *string   `json:"device_serial_number"`
	FormulaName        string    `json:"formula_name"`
	FormulaVersion     string    `json:"formula_version"`
	VulnerabilityID    string    `json:"vulnerability_id"`
	CVSSSeverity       *string   `json:"cvss_severity"`
	CVSSScore          *float64  `json:"cvss_score"`
}

// VulnerabilityChangesResponse is the response from GET /vulnerability_changes.json
type VulnerabilityChangesResponse []VulnerabilityChange

// RequestQueryOptions represents optional query parameters for vulnerability changes requests
type RequestQueryOptions struct {
	Status   string // Filter by status: detected or fixed
	Query    string // Search query for formula name, version, vulnerability ID, or device
	Download bool   // For CSV: force download as attachment (set to true to add download=1)
}
